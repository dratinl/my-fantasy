<!DOCTYPE html>
<html lang="en">

  <head>
    <style type="text/css">
      html {
        height: 100%;
        width: 100%;
        text-align: center;
        line-height: 1.6;
        font-weight: 400;
        overflow: auto;
      }
      body{
        display: inline-block;
        height: 100%;
        width: 100%;
      }
      .myheader{
        width: 100%;
        margin: 0 0 0 0;
        padding-bottom: 8px;
        padding-top: 8px;
        background: #5D2C72;
        
      }
      .headerText{
        font-family: 'Raleway', sans-serif;
        color: white;
        padding-bottom: 8px;
        font-size: 24px;

      }
      .mymaincontent{

        height: 100%;
        width: 100%;
        margin: 0 0 0 0;
      }
      .mytabs{
        overflow: hidden;
        margin-top: 20px;

      }
      .mytabs a{
        text-transform: uppercase;
        cursor: pointer;
        font-size: 14px;
        padding: 0.5rem 1.5rem;
        color: #33475b;
        transition: background-color 0.2s;
        border: 1px solid #ccc;
        border-right: none;
        border-radius: 10px 10px 0 0;
        font-weight: bold;
        display: inline-block;

      }
      .mytabs a:last-child{
        border-right: 1px solid #ccc;
      }
      .mytabs a:hover{
        background-color: #aaa;
        color: #fff;
      }
      .mytabs a.active{
        background-color: #fff;
        color: #484848;
        border-bottom: 2px solid #fff;
        cursor: default;
      }
      .weekTab{
        overflow: hidden;
        margin-top: 10px;
      }
      .weekTab a{
        cursor: pointer;
        font-size: 14px;
        padding: 0.5rem 1.5rem;
        color: #33475b;
        transition: background-color 0.2s;
        border-left: 1px solid #ccc;
        border-right: none;
        display: inline-block;
      }
      .weekTab a:last-child {
        border-right: 1px solid #ccc;
      }
      .weekTab a:hover{
        background-color: #aaa;
        color: #fff;
      }
      .weekTab a.active{
        background-color: #fff;
        color: #484848;
        border-bottom: 2px solid #ccc;
        cursor: default;
      }
      .mycontainer{
        width: 100%;
        background: #e5e5e5;
        margin-top: 0;
        height: auto;
        min-height: 50px;
        border-bottom: 1px solid #5e5e5e;

      }
      .mycontainer h3{
        padding-top: 10px;
      }
      .mycontent{
        margin: 0 0 0 0; 
        height: 100%; 
        text-align: left
      }
      .mycol{
        background: #e5e5e5;
        width: 90%;
        display: inline-block;
        border: 1px solid #ccc;
        border-radius: 10px;
        height: auto;
        box-shadow: 2px 2px 6px #e1e1e1;
      }
      .SinglePlayerDetails{
        width: 100%;
        height: auto;
        background: white;
        border-bottom: double;
        text-align:left;
        display: inline-block;
      }
      .PlayerDesc{
        padding: 40px 0px 40px 40px;
        width: auto;
        max-width: 40%;
        font-weight: 600;
        font-size: calc(14px + 0.9vmax);
        display: inline-block;
      }

      .PlayerRole{
        font-weight: 400;
        font-size: calc(8px + 0.5vmax);
      }
      .PlayerStats{
        max-width: 60%;
        padding: 40px;
        font-size: calc(8px + 0.9vmax);
        float: right;
      }

      .PlayerData{
        clear: both;
      }

      .ColumnLabel{
        font-size: calc(6px + 0.3vw);
        line-height: 10px;
        color: black;
        font-weight: normal;
        height: 10px;
      }

      .SingleCol{
        float:right;
        min-width:60px;
        margin: 10px;
        white-space: nowrap;
        text-align: center;
      }

    </style>
    <meta charset="utf-8">
    <!-- <meta http-equiv="X-UA-Compatible" content="IE=edge"> -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.0/css/bootstrap.min.css">
    
    <title>my-fantasy</title>

    
    <script>
      function getScores(){
        if (app1.ffteams.length > 0){
          for (var i=0; i<app1.ffteams.length; i++){
            var tim = app1.ffteams[i]
            var tim_score_card = []
            for(k=0; k < 10; k++){
              var score=0
              for (var j=0; j<app1.players.length; j++){
                var pim = app1.players[j]
                if (pim.ffteam == tim.team_name){
                  score+=Number(pim.score[k])
                }
              }
              tim_score_card.push(score.toFixed(2))
            }
            tim.stats.record = tim_score_card
          }
        }
      }
    </script>
    <script>
      function setScores(){
        if (app1.players.length > 0) {
          var t_scores = []
          for (var j=0; j < app1.players.length; j++){
            var symbol = app1.players[j]
            var score_card = [];
            for (i = 0; i < 10; i++) {
              var k, d, a, cs, g, score = null;
              var day1 = (i * 2)
              var day2 = (i * 2) + 1
              k = Number(symbol.stats.kills[day1]) + Number(symbol.stats.kills[day2])
              d = Number(symbol.stats.deaths[day1]) + Number(symbol.stats.deaths[day2])
              a = Number(symbol.stats.assists[day1]) + Number(symbol.stats.assists[day2])
              cs = Number(symbol.stats.cs[day1]) + Number(symbol.stats.cs[day2])
              g = Number(symbol.stats.gold[day1]) + Number(symbol.stats.gold[day2])
              score = k - 0.75*d + 0.5*a + 0.01*cs + 0.1*g
              score_card.push(score.toFixed(2))
            }
            symbol.score = score_card
          }
        }  
      }
    </script>

  </head>

  <body style="height:100%; width: 100%; display: inline; background: white; ">
    <noscript>
      <strong>We're sorry but my-fantasy doesn't work properly without JavaScript enabled. Please enable it to continue.</strong>
    </noscript>

    <div id="app1" style="height: 100%; width: 100%; position: relative; ">
      <div class="myheader"  >
        <!-- Team selection -->
        <div class="headerText">Who are you?</div>
        <select v-model="selectedTeam" id="teamSelector" >
          <option style="display:none" disabled selected> select a team </option>
          <option v-for="team in ffteams" v-bind:value="team.team_name">{{team.name}}</option>
        </select>

      </div>

      <div class="mymaincontent" v-show="selectedTeam">
        <div class="mytabs">
          <a v-on:click="activeTab=1" v-bind:class="[activeTab === 1 ? 'active' : '' ]">Roster</a>
          <a v-on:click="activeTab=2" v-bind:class="[activeTab === 2 ? 'active' : '' ]">Standings</a>
          <a v-on:click="activeTab=3" v-bind:class="[activeTab === 3 ? 'active' : '' ]">Free Agency</a>
        </div>

        <!-- Roster information -->
        <div v-if="activeTab === 1" class="mycol">
          <div class="weekTab">
            <a v-on:click="inputWeek=0" v-bind:class="[inputWeek === 0 ? 'active' : '' ]">1</a>
            <a v-on:click="inputWeek=1" v-bind:class="[inputWeek === 1 ? 'active' : '' ]">2</a>
            <a v-on:click="inputWeek=2" v-bind:class="[inputWeek === 2 ? 'active' : '' ]">3</a>
            <a v-on:click="inputWeek=3" v-bind:class="[inputWeek === 3 ? 'active' : '' ]">4</a>
            <a v-on:click="inputWeek=4" v-bind:class="[inputWeek === 4 ? 'active' : '' ]">5</a>
            <a v-on:click="inputWeek=5" v-bind:class="[inputWeek === 5 ? 'active' : '' ]">6</a>
            <a v-on:click="inputWeek=6" v-bind:class="[inputWeek === 6 ? 'active' : '' ]">7</a>
            <a v-on:click="inputWeek=7" v-bind:class="[inputWeek === 7 ? 'active' : '' ]">8</a>
            <a v-on:click="inputWeek=8" v-bind:class="[inputWeek === 8 ? 'active' : '' ]">9</a>
          </div>
          <!-- Team information -->
          <div class="mycontainer" >
            <h3>{{ selectedTeam }}</h3>
            <!-- <select v-model="inputWeek" style="margin: auto auto; display: block; ">
              <option v-for="n in 9" v-bind:value="n - 1">Week {{n}}</option>
            </select> -->
          </div>
          <div v-for="player in players" >
            <div  v-show="player.ffteam ===  selectedTeam">
              <div class="SinglePlayerDetails">
                <div class="PlayerDesc">
                  {{ player.name }}
                  <div class="PlayerRole">
                    <p v-if="player.role === 'Jungler' || player.role === 'Coach' || player.role === 'Support'">{{player.lcsteam}} {{player.role}}</p>
                    <p v-else>{{player.lcsteam}} {{player.role}} Lane </p>
                  </div>
                </div>
                <div class="PlayerStats">
                  <div class="PlayerData">
                    <div class="SingleCol">
                      <div class="ColumnLabel">Gold</div>
                      {{ player.stats.gold[inputWeek*2 + 1] }}k
                    </div>
                    <div class="SingleCol">
                      <div class="ColumnLabel">CS</div>
                      {{ player.stats.cs[inputWeek*2 + 1] }}
                    </div>
                    <div class="SingleCol">
                      <div class="ColumnLabel">KDA</div>
                      {{ player.stats.kills[inputWeek*2 + 1] }}/{{ player.stats.deaths[inputWeek*2 + 1] }}/{{ player.stats.assists[inputWeek*2 + 1] }}
                    </div>  
                  </div>
                  <div class="PlayerData">
                    <div class="SingleCol">
                      <div class="ColumnLabel">Gold</div>
                      {{ player.stats.gold[inputWeek*2 + 1] }}k
                    </div>
                    <div class="SingleCol">
                      <div class="ColumnLabel">CS</div>
                      {{ player.stats.cs[inputWeek*2 + 1] }}
                    </div>
                    <div class="SingleCol">
                      <div class="ColumnLabel">KDA</div>
                      {{ player.stats.kills[inputWeek*2 + 1] }}/{{ player.stats.deaths[inputWeek*2 + 1] }}/{{ player.stats.assists[inputWeek*2 + 1] }}
                    </div>  
                  </div>
                  <div class="PlayerData">
                    <div class="SingleCol" >
                      <div class="ColumnLabel">Score</div>
                      <b>{{ player.score[inputWeek] }}</b>
                    </div>
                  </div>
                </div>

              </div>
            </div>
          </div>
        </div>

        <!-- Standings -->
        <div v-if="activeTab === 2" class="mycol">
          <div class="weekTab">
            <a v-on:click="inputWeek=0" v-bind:class="[inputWeek === 0 ? 'active' : '' ]">1</a>
            <a v-on:click="inputWeek=1" v-bind:class="[inputWeek === 1 ? 'active' : '' ]">2</a>
            <a v-on:click="inputWeek=2" v-bind:class="[inputWeek === 2 ? 'active' : '' ]">3</a>
            <a v-on:click="inputWeek=3" v-bind:class="[inputWeek === 3 ? 'active' : '' ]">4</a>
            <a v-on:click="inputWeek=4" v-bind:class="[inputWeek === 4 ? 'active' : '' ]">5</a>
            <a v-on:click="inputWeek=5" v-bind:class="[inputWeek === 5 ? 'active' : '' ]">6</a>
            <a v-on:click="inputWeek=6" v-bind:class="[inputWeek === 6 ? 'active' : '' ]">7</a>
            <a v-on:click="inputWeek=7" v-bind:class="[inputWeek === 7 ? 'active' : '' ]">8</a>
            <a v-on:click="inputWeek=8" v-bind:class="[inputWeek === 8 ? 'active' : '' ]">9</a>
          </div>
          <div class="mycontainer">
            <h3>Standings</h3>
          </div>
          <div class="mycontent">
            <div v-for="team in ffteams">
              <div class="SinglePlayerDetails">
                <div class="PlayerDesc" style="padding-left: 20%;width: 50%">
                  {{team.team_name}}
                  <div class="PlayerRole">
                    <p>{{team.name}}</p>
                  </div>
                </div>
                <div class="PlayerStats" style="width: 50%">
                  <div class="PlayerData" style="padding-right: 30%; padding-top: 40px">
                    <div class="SingleCol">
                      <div class="ColumnLabel">Score</div>
                      <b>{{ team.stats.record[inputWeek] }}</b>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Available Players -->
        <div v-if="activeTab === 3" class="mycol" >
          <div class="weekTab">
            <a v-on:click="inputWeek=0" v-bind:class="[inputWeek === 0 ? 'active' : '' ]">1</a>
            <a v-on:click="inputWeek=1" v-bind:class="[inputWeek === 1 ? 'active' : '' ]">2</a>
            <a v-on:click="inputWeek=2" v-bind:class="[inputWeek === 2 ? 'active' : '' ]">3</a>
            <a v-on:click="inputWeek=3" v-bind:class="[inputWeek === 3 ? 'active' : '' ]">4</a>
            <a v-on:click="inputWeek=4" v-bind:class="[inputWeek === 4 ? 'active' : '' ]">5</a>
            <a v-on:click="inputWeek=5" v-bind:class="[inputWeek === 5 ? 'active' : '' ]">6</a>
            <a v-on:click="inputWeek=6" v-bind:class="[inputWeek === 6 ? 'active' : '' ]">7</a>
            <a v-on:click="inputWeek=7" v-bind:class="[inputWeek === 7 ? 'active' : '' ]">8</a>
            <a v-on:click="inputWeek=8" v-bind:class="[inputWeek === 8 ? 'active' : '' ]">9</a>
          </div>
          <div class="mycontainer" >
            <h3>Available Players</h3>
            <select v-model="inputRole" style="margin: auto auto; display: block">
              <option>All</option>
              <option>Top</option>
              <option>Jungler</option>
              <option>Mid</option>
              <option>Bot</option>
              <option>Sup</option>
            </select>
          </div>
          <div v-for="player in players">
            <div v-if="inputRole === player.role || inputRole === 'All'">
              <div v-if="player.ffteam ==='no one'" class="SinglePlayerDetails">
                <div class="PlayerDesc">
                  {{player.lcsteam}} {{ player.name }}
                  <div class="PlayerRole">
                    <p v-if="player.role === 'Jungler' || player.role === 'Coach' || player.role === 'Support'">{{player.role}}</p>
                    <p v-else>{{player.role}} Lane</p>
                  </div>
                </div>
                <div class="PlayerStats">
                  <div class="PlayerData">
                    <div class="SingleCol">
                      <div class="ColumnLabel">Gold</div>
                      {{ player.stats.gold[inputWeek*2 + 1] }}k
                    </div>
                    <div class="SingleCol">
                      <div class="ColumnLabel">CS</div>
                      {{ player.stats.cs[inputWeek*2 + 1] }}
                    </div>
                    <div class="SingleCol">
                      <div class="ColumnLabel">KDA</div>
                      {{ player.stats.kills[inputWeek*2 + 1] }}/{{ player.stats.deaths[inputWeek*2 + 1] }}/{{ player.stats.assists[inputWeek*2 + 1] }}
                    </div>  
                  </div>
                  <div class="PlayerData">
                    <div class="SingleCol">
                      <div class="ColumnLabel">Gold</div>
                      {{ player.stats.gold[inputWeek*2 + 1] }}k
                    </div>
                    <div class="SingleCol">
                      <div class="ColumnLabel">CS</div>
                      {{ player.stats.cs[inputWeek*2 + 1] }}
                    </div>
                    <div class="SingleCol">
                      <div class="ColumnLabel">KDA</div>
                      {{ player.stats.kills[inputWeek*2 + 1] }}/{{ player.stats.deaths[inputWeek*2 + 1] }}/{{ player.stats.assists[inputWeek*2 + 1] }}
                    </div>  
                  </div>
                  <div class="PlayerData" >
                    <div class="SingleCol">
                      <div class="ColumnLabel">Score</div>
                      <b>{{ player.score[inputWeek] }}</b>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <!-- misc scripts -->
    <script src="https://unpkg.com/vue@2.4.2"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.0/js/bootstrap.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/lodash@4.17.11/lodash.min.js"></script>

    <!-- Vue.js app js -->
    <script type="text/javascript">
      var app1 = new Vue({
        el: '#app1',
        data: {
          players: [],
          ffteams: [],
          ff_scores: [],
          selectedTeam: null,
          activeTab: 1,
          inputWeek: 0,
          inputRole: 'All'
        },
        beforeCreate: function() {
          // Gets data from json files and stores above
          fetch("/teams.json") 
            .then(res => res.json())
            .then(json => {
              this.ffteams = json.ffteams;
            })
          fetch("/players.json") 
            .then(r => r.json())
            .then(json => {
              this.players = json.players;
            })
        },
      })
    </script>
    <script>
      // Calculates scores after page is loaded
      function start(){
        document.getElementById("teamSelector").addEventListener("change", doStuff,)
      }
      function doStuff(){
        setScores();
        getScores();
      }
      window.addEventListener("load", start, false)
    </script>

  </body>

</html>
